on_actions = {
	on_new_term_election = {
		random_events = {
			100 = south_africa_wr.7
		}
	}
	on_assume_faction_leadership = {
		effect = {
			if = {
				limit = { FROM = { tag = ENT } }
				FROM = { remove_ideas = ENT_leader }
				save_global_event_target_as = leader_of_national_entente
				add_ideas = ENT_leader
			}
			if = {
				limit = { FROM = { tag = REI } }
				FROM = { remove_ideas = REI_leader }
				save_global_event_target_as = leader_of_reichspakt
				add_ideas = REI_leader
			}
			if = {
				limit = { FROM = { tag = UNF } }
				save_global_event_target_as = leader_of_United_Fronts
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					original_tag = ENG
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_britain_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_britain_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = AUH
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_austria_hungary_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_austria_hungary_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = USA
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_usa_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_usa_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = ITA
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_italy_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_italy_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = TUR
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_ottoman_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_ottoman_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					OR  ={
						original_tag = CAN
						original_tag = AST
						original_tag = NZL
					}
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = CAN
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_canada_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_canada_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = AST
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_australia_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_australia_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = NZL
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_new_zealand_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_new_zealand_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					OR  ={
						original_tag = IRE
						original_tag = DEN
						original_tag = NOR
						original_tag = SWE
						original_tag = FIN
					}
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = IRE
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_ireland_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_ireland_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = DEN
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_denmark_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_denmark_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = NOR
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_norway_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_norway_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = SWE
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_sweden_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_sweden_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = FIN
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_finland_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_finland_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					SPA = { exists = yes }
				}
				if = {
					limit = {
						tag = SPA
						has_global_flag = second_world_war
					}
					if = {
						limit = {
							FROM = { is_subject = no }
						}
						FROM = { set_country_flag = defeat_spain_flag }
						else = {
							every_country = {
								limit = {
									has_subject = FROM
								}
								set_country_flag = defeat_spain_flag
							}
						}
					}
				}
				else_if = {
					limit = {
						SPR = { exists = yes }
					}
				}
				if = {
					limit = {
						tag = SPR
						has_global_flag = second_world_war
					}
					if = {
						limit = {
							FROM = { is_subject = no }
						}
						FROM = { set_country_flag = defeat_spain_flag }
						else = {
							every_country = {
								limit = {
									has_subject = FROM
								}
								set_country_flag = defeat_spain_flag
							}
						}
					}
				}
			}
			#Second Great War - Fall of Comintern by Reichspakt
            if = {
                limit = {
					original_tag = SOV
					any_enemy_country = {
						original_tag = GER
					}
					GER = { is_subject = no }
					has_global_flag = german_soviet_war
					NOT = {
						has_global_flag = german_soviet_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
							has_war_with = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
						NOT = {
							OR = {
								original_tag = GER
								is_in_faction_with = GER
								is_subject_of = GER
								original_tag = JAP
								is_in_faction_with = JAP
								is_subject_of = JAP
							}
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						JAP = {
							has_war_with = SOV
							has_capitulated = no
						}
					}
					JAP = { country_event = japan_wr.18 }
				}
				SOV = {
					add_ideas = Treaty_of_Kazan1
					country_lock_all_division_template = yes
					if = {
						limit = {
							SOV = { NOT = { is_faction_leader = yes } }
						}
						every_country = {
							limit = {
								OR = {
									original_tag = SOV
									is_subject_of = SOV
								}
							}
							leave_faction = yes
						}
					}
					if = {
						limit = {
							SOV = { is_faction_leader = yes }
						}
						dismantle_faction = yes
					}
					remove_ideas = home_of_revolution
				}
				every_country = {
					limit = {
						has_war_with = SOV
					}
					white_peace = {
						tag = SOV
						message = unconditional_surrender_of_SOV
					}
					if = {
						limit = {
							MON = { set_country_flag = anti_russia_war_loser }
						}
						white_peace = {
							tag = MON
						}
					}
				}
				SOV = {
					annex_country = {
						target = SOV
						transfer_troops = yes
					}
				}
				GER = { country_event = Germany.71 }
				clr_global_flag = german_soviet_war
				set_global_flag = german_soviet_war_ends
				peace_conference_effect_for_russia = yes
			}
			#Second Great War - Fall of Russia by Reichspakt
            if = {
                limit = {
					original_tag = RUS
					any_enemy_country = {
						original_tag = GER
					}
					GER = { is_subject = no }
					has_global_flag = german_russian_war
					NOT = {
						has_global_flag = german_russian_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
							has_war_with = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
						NOT = {
							OR = {
								original_tag = GER
								is_in_faction_with = GER
								is_subject_of = GER
								original_tag = JAP
								is_in_faction_with = JAP
								is_subject_of = JAP
							}
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						JAP = {
							has_war_with = RUS
							has_capitulated = no
						}
					}
					JAP = { country_event = japan_wr.19 }
				}
				RUS = {
					add_ideas = Treaty_of_Nizhny_Novgorod
					country_lock_all_division_template = yes
					if = {
						limit = {
							RUS = { NOT = { is_faction_leader = yes } }
						}
						every_country = {
							limit = {
								OR = {
									original_tag = RUS
									is_subject_of = RUS
								}
							}
							leave_faction = yes
						}
					}
					if = {
						limit = {
							RUS = { is_faction_leader = yes }
						}
						dismantle_faction = yes
					}
					remove_ideas = home_of_revolution
				}
				every_country = {
					limit = {
						has_war_with = RUS
					}
					white_peace = {
						tag = RUS
						message = unconditional_surrender_of_RUS
					}
					if = {
						limit = {
							MON = { set_country_flag = anti_russia_war_loser }
						}
						white_peace = {
							tag = MON
						}
					}
				}
				RUS = {
					annex_country = {
						target = RUS
						transfer_troops = yes
					}
				}
				GER = { country_event = Germany.88 }
				clr_global_flag = german_russian_war
				set_global_flag = german_russian_war_ends
				peace_conference_effect_for_russia = yes
			}
			#fall of Germany by sov
			if = {
                limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = SOV
					}
					has_global_flag = german_soviet_war
					NOT = {
						has_global_flag = german_soviet_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						OR = {
							FRA = { has_country_flag = anti_russia_war_loser }
							AND = {
								NOT = { ENT = { has_war_with = REI } }
								FRA = { has_country_flag = anti_russia_war_winner }
							}
						}
					}
					peace_conference_effect_for_russia = yes
				}
			}
			#fall of Germany by rus
			if = {
                limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = RUS
					}
					has_global_flag = german_russian_war
					NOT = {
						has_global_flag = german_russian_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						OR = {
							FRA = { has_country_flag = anti_russia_war_loser }
							AND = {
								NOT = { ENT = { has_war_with = REI } }
								FRA = { has_country_flag = anti_russia_war_winner }
							}
						}
					}
					peace_conference_effect_for_russia = yes
				}
			}
			if = {
				limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = AUH
					}
					has_global_flag = Deutscher_Krieg
					AUH = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = Deutscher_Krieg
				ITA = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
						}
						leave_faction = yes
					}
				}
				ROM = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
							is_in_faction_with = GER
						}
						leave_faction = yes
					}
				}
				AUH = {
					country_event = AUH.34
					save_global_event_target_as = leader_of_reichspakt
				}
			}
			if = {
				limit = {
					original_tag = ITA
					any_enemy_country = {
						original_tag = AUH
					}
					has_country_flag = join_brothers_war
					AUH = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
							is_in_faction_with = GER
						}
						leave_faction = yes
					}
				}
				AUH = {
					country_event = AUH.36
				}
			}
			if = {
				limit = {
					original_tag = AUH
					has_global_flag = Deutscher_Krieg
					GER = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				GER = {
					country_event = Germany.77
				}
			}
			if = {
				limit = {
					original_tag = SOM
					has_global_flag = ita_som_war
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					news_event = italy.27
				}
			}
			if = {
				limit = {
					original_tag = PER
					has_global_flag = PER_TUR_war
					TUR = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				TUR = {
					country_event = turkey.37
				}
			}
			if = {
				limit = {
					original_tag = BUL
					has_global_flag = fourth_balkan_war
					GRE = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
					NOT = {
						OR = {
							is_in_faction_with = GER
							is_in_faction_with = FRA
						}
					}
				}
				clr_global_flag = fourth_balkan_war
				every_country = {
					limit = {
						OR = {
							is_in_faction_with = GRE
							is_subject_of = GRE
						}
						has_war_with = BUL
					}
					white_peace = BUL
					set_country_flag = victory_against_bulgaria
				}
				BUL = {
					add_popularity = {
						ideology = neutrality
						popularity = -0.2
					}
					add_popularity = {
						ideology = fascism
						popularity = 0.1
					}
					add_popularity = {
						ideology = communism
						popularity = 0.1
					}
					add_war_support = -0.1
					add_stability = -0.1
					remove_ideas = victor_of_the_Balkan_War
					add_ideas = BUL_idea_second_national_catastrophe
					set_country_flag = fall_of_bul
				}
				GRE = { country_event = greece.15 remove_ideas = GRE_anti_Bulgarian_sentiment }
			}
			if = {
				limit = {
					original_tag = GRE
					has_global_flag = fourth_balkan_war
					BUL = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = fourth_balkan_war
				news_event = greece.22
			}
			if = {
				limit = {
					original_tag = GRE
					has_global_flag = greece_ottoman_war
					TUR = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = greece_ottoman_war
				GRE = {
					remove_ideas = GRE_anti_Ottoman_sentiment
				}
			}
			if = {
				limit = {
					original_tag = TUR
					has_global_flag = greece_ottoman_war
					GRE = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = TUR
						OR = {
							is_core_of = GRE
							is_claimed_by = GRE
						}
					}
					transfer_state_to = GRE
				}
				GRE = {
					remove_ideas = GRE_anti_Ottoman_sentiment
				}
				clr_global_flag = greece_ottoman_war
				TUR = { set_capital = { state = 49 } }
			}
			#Ukraine Civilwar for UKR
			if = {
				limit = {
					original_tag = UPR
					has_global_flag = ukraine_civil_war
					UKR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UPR
					}
					transfer_state_to = UKR
				}
			}
			if = {
				limit = {
					original_tag = USS
					has_global_flag = ukraine_civil_war
					UKR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = USS
					}
					transfer_state_to = UKR
				}
			}
			#Ukraine Civilwar for UPR
			if = {
				limit = {
					original_tag = UKR
					has_global_flag = ukraine_civil_war
					UPR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UKR
					}
					transfer_state_to = UPR
				}
			}
			if = {
				limit = {
					original_tag = USS
					has_global_flag = ukraine_civil_war
					UPR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = USS
					}
					transfer_state_to = UPR
				}
			}
			#Ukraine Civilwar for USS
			if = {
				limit = {
					original_tag = UKR
					has_global_flag = ukraine_civil_war
					USS = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UKR
					}
					transfer_state_to = USS
				}
			}
			if = {
				limit = {
					original_tag = UPR
					has_global_flag = ukraine_civil_war
					USS = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UPR
					}
					transfer_state_to = USS
				}
			}
			#SPR Civilwar
			if = {
				limit = {
					tag = SPA
					has_global_flag = spanish_civil_war
					SPD = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = SPA
					}
					remove_core_of = SPA
				}
				SPD = { annex_country = { target = SPA transfer_troops = yes } }
				SPD = { news_event = spain.8 }
			}
			if = {
				limit = {
					tag = SPD
					has_global_flag = spanish_civil_war
					SPA = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = SPR
					}
					remove_core_of = SPR
					add_core_of = SPA
				}
				SPA = { annex_country = { target = SPD transfer_troops = yes } }
				SPA = { news_event = spain.7 }
			}
			#French Civilwar
			if = {
				limit = {
					tag = FRS
					FRA = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = FRS
					}
					remove_core_of = FRS
				}
				FRA = { annex_country = { target = FRS transfer_troops = yes } country_event = france.46 }
			}
			if = {
				limit = {
					tag = FRA
					FRS = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = FRA
					}
					remove_core_of = FRA
				}
				FRS = { annex_country = { target = FRA transfer_troops = yes } country_event = france.46 }
			}
			#Mukden incident
			if = {
				limit = {
					original_tag = FNG
					FNG = { is_in_faction = no }
					JAP = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_country = {
					limit = {
						has_war_with = FNG
						OR = {
							original_tag = JAP
							is_in_faction_with = JAP
							is_subject_of = JAP
						}
					}
					white_peace = FNG
				}
				clr_global_flag = JAP_Mukden_incident_flag
				set_global_flag = end_of_mukden_incident_flag
				JAP = {
					if = {
						limit = {
							OR = {
								has_dlc = "Together for Victory"
								has_dlc = "Waking the Tiger"
							}
						}
						set_autonomy = {
							target = MAN
							autonomous_state = autonomy_wtt_imperial_protectorate
							freedom_level = 0.5
						}
						else = {
							puppet = MAN
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						OR = {
							state = 716
							state = 328
							state = 717
							state = 610
							state = 715
							state = 714
							state = 761
							state = 961
						}
					}
					add_core_of = MAN
					transfer_state_to = MAN
				}
				JAP = {
					if = {
						limit = {
							OR = {
								has_dlc = "Together for Victory"
								has_dlc = "Waking the Tiger"
							}
						}
						set_autonomy = {
							target = MEN
							autonomous_state = autonomy_wtt_imperial_protectorate
							freedom_level = 0.5
						}
						else = {
							puppet = MEN
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						OR = {
							state = 612
							state = 611
						}
					}
					add_core_of = MEN
					transfer_state_to = MEN
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						state = 609
					}
					transfer_state_to = JAP
				}
				if = {
					limit = {
						FNG = { has_war_with = CHI }
					}
					every_country = {
						limit = {
							has_war_with = FNG
							OR = {
								original_tag = CHI
								is_in_faction_with = CHI
								is_subject_of = CHI
							}
						}
						white_peace = FNG
					}
					every_state = {
						limit = {
							is_core_of = FNG
						}
						remove_core_of = FNG
						add_core_of = CHI
					}
					CHI = { annex_country = { target = FNG transfer_troops = yes } }
				}
				JAP = { country_event = japan_wr.16 }
				if = {
					limit = {
						NOT = { FNG = { has_war_with = CHI } }
					}
					FNG = { news_event = { id = wr_news.2 days = 14 } }
				}
			}
			#KMT civil war
			if = {
				limit = {
					tag = CHI
					has_global_flag = kmt_civil_war
					CHR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				CHR = { annex_country = { target = CHI transfer_troops = yes } }
				every_state = {
					limit = {
						is_core_of = CHI
					}
					remove_core_of = CHI
				}
				clr_global_flag = kmt_civil_war
			}
			if = {
				limit = {
					tag = CHR
					has_global_flag = spanish_civil_war
					CHI = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				CHI = { annex_country = { target = CHR transfer_troops = yes } }
				every_state = {
					limit = {
						is_core_of = CHR
					}
					remove_core_of = CHR
				}
				clr_global_flag = kmt_civil_war
			}
			#소련내전
			if = {
				limit = {
					tag = SOS
					has_global_flag = soviet_civilwar_focus
					SOT = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOT = {
					annex_country = {
						target = SOS
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOB }
					}
					SOT = { news_event = Soviet.42 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOB
					has_global_flag = soviet_civilwar_focus
					SOT = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOT = {
					annex_country = {
						target = SOB
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOS }
					}
					SOT = { news_event = Soviet.42 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOT
					has_global_flag = soviet_civilwar_focus
					SOS = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOS = {
					annex_country = {
						target = SOT
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOB }
					}
					SOS = { news_event = Soviet.46 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOB
					has_global_flag = soviet_civilwar_focus
					SOS = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOS = {
					annex_country = {
						target = SOB
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOT }
					}
					SOS = { news_event = Soviet.46 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOT
					SOB = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOB = {
					annex_country = {
						target = SOT
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOS }
					}
					SOB = { news_event = Soviet.47 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOS
					has_global_flag = soviet_civilwar_focus
					SOB = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOB = {
					annex_country = {
						target = SOS
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOT }
					}
					SOB = { news_event = Soviet.47 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOV
					has_global_flag = second_russian_civilwar
					RUS = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				RUS = {
					annex_country = {
						target = SOV
						transfer_troops = yes
					}
				}
				clr_global_flag = second_russian_civilwar
				RUS = {
					news_event = Soviet.51
					add_ideas = civilian_economy
					add_ideas = export_focus
					add_ideas = volunteer_only
					add_timed_idea = { idea = RUS_aftermath_of_civilwar days = 200 }
				}
				every_state = {
					limit = {
						is_core_of = SOV
					}
					add_core_of = RUS
					remove_core_of = SOV
				}
			}
			if = {
				limit = {
					tag = RUS
					has_global_flag = second_russian_civilwar
					SOV = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOV = {
					annex_country = {
						target = RUS
						transfer_troops = yes
					}
				}
				clr_global_flag = second_russian_civilwar
				SOV = { news_event = Soviet.52 }
				every_state = {
					limit = {
						is_core_of = RUS
					}
					remove_core_of = RUS
				}
			}
			#이탈리아-에티오피아 전쟁
			if = {
				limit = {
					tag = ETH
					has_global_flag = Second_Italo_Ethiopian_War
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = { annex_country = { target = ETH transfer_troops = no } }
				ITA = {
					news_event = italy.49
				}
			}
			if = {
				limit = {
					tag = TUR
					has_global_flag = second_ita_otto_war_refuse
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					news_event = italy.38
				}
			}
			#중일전쟁
			if = {
				limit = {
					original_tag = JAP
					has_global_flag = second_Sino_Japanese_war_flag
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_japan_flag }
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_japan_flag
						}
					}
				}
				clr_global_flag = second_Sino_Japanese_war_flag
				set_global_flag = for_conference_about_japs
				if = {
					limit = {
						SOV = {
							has_war_with = JAP
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = SOV
								is_claimed_by = SOV
							}
						}
						remove_core_of = JAP
						remove_claim_by = JAP
					}
					every_state = {
						limit = {
							OR = {
								state = 537
								state = 555
							}
						}
						add_core_of = SOV
						remove_core_of = JAP
					}
				}
				if = {
					limit = {
						RUS = {
							has_war_with = JAP
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = RUS
								is_claimed_by = RUS
							}
						}
						remove_core_of = JAP
						remove_claim_by = JAP
					}
					every_state = {
						limit = {
							OR = {
								state = 537
								state = 555
							}
						}
						add_core_of = RUS
						remove_core_of = JAP
					}
				}
				if = {
					limit = {
						CHI = {
							has_war_with = JAP
							is_subject = no
							has_capitulated = no
						}
					}
					if = {
						limit = {
							CHI = { has_war_with = MAN }
						}
						#CHI = { annex_country = { target = MAN transfer_troops = no } }
						every_state = {
							limit = {
								is_core_of = MAN
							}
							add_core_of = CHI
							remove_core_of = MAN
						}
					}
					if = {
						limit = {
							CHI = { has_war_with = MEN }
						}
						#CHI = { annex_country = { target = MEN transfer_troops = no } }
						every_state = {
							limit = {
								is_core_of = MEN
							}
							add_core_of = CHI
							remove_core_of = MEN
						}
					}
					if = {
						limit = {
							CHI = { has_war_with = FNG }
							FNG = { is_in_faction_with = JAP }
						}
						#CHI = { annex_country = { target = FNG transfer_troops = no } }
						every_state = {
							limit = {
								is_core_of = FNG
							}
							add_core_of = CHI
							remove_core_of = FNG
						}
					}
					every_state = {
						limit = {
							is_owned_by = JAP
							OR = {
								is_chinese_area = yes
								state = 524
							}
						}
						transfer_state_to = CHI
					}
					UNF = { dismantle_faction = yes }
					#CHI = { country_event = { id = china_wr.25 days = 7 } }
				}
			}
			#for achievements
			if = {
				limit = {
					FROM = {
						original_tag = GER
					}
					original_tag = FRA
				}
				FROM = { set_country_flag = another_schlieffen_plan_flag }
			}
			if = {
				limit = {
					FROM = {
						original_tag = JAP
					}
					original_tag = GER
				}
				FROM = { set_country_flag = yellow_peril_flag }
			}
			if = {
				limit = {
					has_war_with = FRA
					OR = {
						original_tag = SOV
						original_tag = RUS
					}
					FRA = { has_country_flag = second_great_war_winner }
				}
				FRA = { set_country_flag = revenge_of_1812_flag }
			}
		}
	}
	on_peaceconference_started = {
		effect = {
			if = {
				limit = {
					FROM = {
						original_tag = CHI
						is_faction_leader = yes
					}
					has_global_flag = second_Sino_Japanese_war_flag
				}
				CHI = { dismantle_faction = yes }
				clr_global_flag = second_Sino_Japanese_war_flag
			}
		}
	}
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					has_global_flag = for_conference_about_japs
				}
			}
			clr_global_flag = for_conference_about_japs
			every_country = {
				limit = {
					has_country_flag = defeat_japan_flag
				}
				clr_country_flag = defeat_japan_flag
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					original_tag = FRA
					is_subject_of = GER
					NOT = {
						any_country = {
							has_cosmetic_tag = FRG
						}
					}
				}
				if = {
					limit = {
						GER = {
							NOT = {
								has_government = communism
							}
						}
					}
					set_cosmetic_tag = FRG
					else = {
						set_cosmetic_tag = FRA_com
					}
				}
				if = {
					limit = {
						GER = {
							has_government = neutrality
						}
					}
					create_country_leader = {
						name = "GER_victoria"
						picture = "gfx/leaders/GER/GER_Victoria_Louise.png"
						ideology = autocracy
						traits = { Imperial_connections }
					}
				}
				create_country_leader = {
					name = "GER_alfred_jodl"
					picture = "GFX_portrait_GER_alfred_jodl" 
					ideology = fascism_ideology
					traits = { foreign_leader allegiance_to_germany }
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = conservatism
					traits = {
						allegiance_to_germany
					}
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = syndicalism
					traits = {
						allegiance_to_germany
					}
				}
				if = {
					limit = {
						GER = {
							has_government = neutrality
						}
					}
					set_party_name = {
						ideology = neutrality
						long_name = GER_neutrality_party_long
						name = GER_neutrality_party
					}
				}
				set_party_name = {
					ideology = democratic
					long_name = FRA_gouvernement_provisoire_long
					name = FRA_gouvernement_provisoire
				}
				set_party_name = {
					ideology = communism
					long_name = FRA_gouvernement_provisoire_long
					name = FRA_gouvernement_provisoire
				}
				set_party_name = {
					ideology = fascism
					long_name = GER_Army_Military_Government_long
					name = GER_Army_Military_Government
				}
			}
			if = {
				limit = {
					original_tag = JAP
				}
				NOT = {
					any_country = {
						has_cosmetic_tag = TSC
					}
				}
				set_cosmetic_tag = TSC
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = despotism
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = fascism_ideology
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = conservatism
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = marxism
				}
			}
		}
	}
	on_join_faction = {
		effect = {
			if = {
				limit = {
					ROOT = { original_tag = FNG }
					FROM = { original_tag = JAP }
				}
				FNG = { set_country_flag = FNG_hanjian }
			}
		}
	}
}